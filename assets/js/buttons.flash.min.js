!function(e){"function"==typeof define&&define.amd?define(["jquery","datatables.net","datatables.net-buttons"],function(t){return e(t,window,document)}):"object"==typeof exports?module.exports=function(t,i){return t||(t=window),i&&i.fn.dataTable||(i=require("datatables.net")(t,i).$),i.fn.dataTable.Buttons||require("datatables.net-buttons")(t,i),e(i,t,t.document)}:e(jQuery,window,document)}(function(e,t,i,s){"use strict";var n=e.fn.dataTable,o={version:"1.0.4-TableTools2",clients:{},moviePath:"",nextId:1,$:function e(t){return"string"==typeof t&&(t=i.getElementById(t)),t.addClass||(t.hide=function(){this.style.display="none"},t.show=function(){this.style.display=""},t.addClass=function(e){this.removeClass(e),this.className+=" "+e},t.removeClass=function(e){this.className=this.className.replace(new RegExp("\\s*"+e+"\\s*")," ").replace(/^\s+/,"").replace(/\s+$/,"")},t.hasClass=function(e){return!!this.className.match(new RegExp("\\s*"+e+"\\s*"))}),t},setMoviePath:function e(t){this.moviePath=t},dispatch:function e(t,i,s){var n=this.clients[t];n&&n.receiveEvent(i,s)},register:function e(t,i){this.clients[t]=i},getDOMObjectPosition:function e(t){var i={left:0,top:0,width:t.width?t.width:t.offsetWidth,height:t.height?t.height:t.offsetHeight};for(""!==t.style.width&&(i.width=t.style.width.replace("px","")),""!==t.style.height&&(i.height=t.style.height.replace("px",""));t;){i.left+=t.offsetLeft,i.top+=t.offsetTop,t=t.offsetParent}return i},Client:function e(t){this.handlers={},this.id=o.nextId++,this.movieId="ZeroClipboard_TableToolsMovie_"+this.id,o.register(this.id,this),t&&this.glue(t)}};o.Client.prototype={id:0,ready:!1,movie:null,clipText:"",fileName:"",action:"copy",handCursorEnabled:!0,cssEffects:!0,handlers:null,sized:!1,sheetName:"",glue:function e(t,s){this.domElement=o.$(t);var n=99;this.domElement.style.zIndex&&(n=parseInt(this.domElement.style.zIndex,10)+1);var a=o.getDOMObjectPosition(this.domElement);this.div=i.createElement("div");var r=this.div.style;r.position="absolute",r.left="0px",r.top="0px",r.width=a.width+"px",r.height=a.height+"px",r.zIndex=n,"undefined"!=typeof s&&""!==s&&(this.div.title=s),0!==a.width&&0!==a.height&&(this.sized=!0),this.domElement&&(this.domElement.appendChild(this.div),this.div.innerHTML=this.getHTML(a.width,a.height).replace(/&/g,"&amp;"))},positionElement:function e(){var t=o.getDOMObjectPosition(this.domElement),i=this.div.style;if(i.position="absolute",i.width=t.width+"px",i.height=t.height+"px",0!==t.width&&0!==t.height){this.sized=!0;var s=this.div.childNodes[0];s.width=t.width,s.height=t.height}},getHTML:function e(t,i){var s="",n="id="+this.id+"&width="+t+"&height="+i;if(navigator.userAgent.match(/MSIE/)){var a=location.href.match(/^https/i)?"https://":"http://";s+='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="'+a+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=10,0,0,0" width="'+t+'" height="'+i+'" id="'+this.movieId+'" align="middle"><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="false" /><param name="movie" value="'+o.moviePath+'" /><param name="loop" value="false" /><param name="menu" value="false" /><param name="quality" value="best" /><param name="bgcolor" value="#ffffff" /><param name="flashvars" value="'+n+'"/><param name="wmode" value="transparent"/></object>'}else s+='<embed id="'+this.movieId+'" src="'+o.moviePath+'" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="'+t+'" height="'+i+'" name="'+this.movieId+'" align="middle" allowScriptAccess="always" allowFullScreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="'+n+'" wmode="transparent" />';return s},hide:function e(){this.div&&(this.div.style.left="-2000px")},show:function e(){this.reposition()},destroy:function t(){var i=this;this.domElement&&this.div&&(e(this.div).remove(),this.domElement=null,this.div=null,e.each(o.clients,function(e,t){t===i&&delete o.clients[e]}))},reposition:function e(t){if(t&&(this.domElement=o.$(t),this.domElement||this.hide()),this.domElement&&this.div){var i=o.getDOMObjectPosition(this.domElement),s=this.div.style;s.left=""+i.left+"px",s.top=""+i.top+"px"}},clearText:function e(){this.clipText="",this.ready&&this.movie.clearText()},appendText:function e(t){this.clipText+=t,this.ready&&this.movie.appendText(t)},setText:function e(t){this.clipText=t,this.ready&&this.movie.setText(t)},setFileName:function e(t){this.fileName=t,this.ready&&this.movie.setFileName(t)},setSheetName:function e(t){this.sheetName=t,this.ready&&this.movie.setSheetName(t)},setAction:function e(t){this.action=t,this.ready&&this.movie.setAction(t)},addEventListener:function e(t,i){t=t.toString().toLowerCase().replace(/^on/,""),this.handlers[t]||(this.handlers[t]=[]),this.handlers[t].push(i)},setHandCursor:function e(t){this.handCursorEnabled=t,this.ready&&this.movie.setHandCursor(t)},setCSSEffects:function e(t){this.cssEffects=!!t},receiveEvent:function e(s,n){var o;switch(s=s.toString().toLowerCase().replace(/^on/,"")){case"load":if(this.movie=i.getElementById(this.movieId),!this.movie)return o=this,void setTimeout(function(){o.receiveEvent("load",null)},1);if(!this.ready&&navigator.userAgent.match(/Firefox/)&&navigator.userAgent.match(/Windows/))return o=this,setTimeout(function(){o.receiveEvent("load",null)},100),void(this.ready=!0);this.ready=!0,this.movie.clearText(),this.movie.appendText(this.clipText),this.movie.setFileName(this.fileName),this.movie.setAction(this.action),this.movie.setHandCursor(this.handCursorEnabled);break;case"mouseover":this.domElement&&this.cssEffects&&this.recoverActive&&this.domElement.addClass("active");break;case"mouseout":this.domElement&&this.cssEffects&&(this.recoverActive=!1,this.domElement.hasClass("active")&&(this.domElement.removeClass("active"),this.recoverActive=!0));break;case"mousedown":this.domElement&&this.cssEffects&&this.domElement.addClass("active");break;case"mouseup":this.domElement&&this.cssEffects&&(this.domElement.removeClass("active"),this.recoverActive=!1)}if(this.handlers[s])for(var a=0,r=this.handlers[s].length;r>a;a++){var l=this.handlers[s][a];"function"==typeof l?l(this,n):"object"==typeof l&&2==l.length?l[0][l[1]](this,n):"string"==typeof l&&t[l](this,n)}}},o.hasFlash=function(){try{var e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(e)return!0}catch(t){if(navigator.mimeTypes&&navigator.mimeTypes["application/x-shockwave-flash"]!==s&&navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin)return!0}return!1},t.ZeroClipboard_TableTools=o;var a=function e(t,i){i.attr("id");i.parents("html").length?t.glue(i[0],""):setTimeout(function(){e(t,i)},500)},r=function t(i,n){var o="*"===i.filename&&"*"!==i.title&&i.title!==s?i.title:i.filename;return"function"==typeof o&&(o=o()),-1!==o.indexOf("*")&&(o=o.replace("*",e("title").text())),o=o.replace(/[^a-zA-Z0-9_\u00A1-\uFFFF\.,\-_ !\(\)]/g,""),n===s||n===!0?o+i.extension:o},l=function e(t){var i="Sheet1";return t.sheetName&&(i=t.sheetName.replace(/[\[\]\*\/\\\?\:]/g,"")),i},h=function t(i){var s=i.title;return"function"==typeof s&&(s=s()),-1!==s.indexOf("*")?s.replace("*",e("title").text()):s},c=function e(t,i){var s=i.match(/[\s\S]{1,8192}/g)||[];t.clearText();for(var n=0,o=s.length;o>n;n++){t.appendText(s[n])}},d=function e(t){return t.newline?t.newline:navigator.userAgent.match(/Windows/)?"\r\n":"\n"},f=function e(t,i){for(var n=d(i),o=t.buttons.exportData(i.exportOptions),a=i.fieldBoundary,r=i.fieldSeparator,l=new RegExp(a,"g"),h=i.escapeChar!==s?i.escapeChar:"\\",c=function e(t){for(var i="",s=0,n=t.length;n>s;s++){s>0&&(i+=r),i+=a?a+(""+t[s]).replace(l,h+a)+a:t[s]}return i},f=i.header?c(o.header)+n:"",e=i.footer&&o.footer?n+c(o.footer):"",u=[],m=0,p=o.body.length;p>m;m++){u.push(c(o.body[m]))}return{str:f+u.join(n)+e,rows:u.length}},u={available:function e(){return o.hasFlash()},init:function e(t,i,s){o.moviePath=n.Buttons.swfPath;var r=new o.Client;r.setHandCursor(!0),r.addEventListener("mouseDown",function(e){s._fromFlash=!0,t.button(i[0]).trigger(),s._fromFlash=!1}),a(r,i),s._flash=r},destroy:function e(t,i,s){s._flash.destroy()},fieldSeparator:",",fieldBoundary:'"',exportOptions:{},title:"*",filename:"*",extension:".csv",header:!0,footer:!1};return n.Buttons.swfPath="assets/swf/flashExport.swf",n.Api.register("buttons.resize()",function(){e.each(o.clients,function(e,t){t.domElement!==s&&t.domElement.parentNode&&t.positionElement()})}),n.ext.buttons.copyFlash=e.extend({},u,{className:"buttons-copy buttons-flash",text:function e(t){return t.i18n("buttons.copy","Copy")},action:function e(t,i,s,n){if(n._fromFlash){var o=n._flash,a=f(i,n),r=n.customize?n.customize(a.str,n):a.str;o.setAction("copy"),c(o,r),i.buttons.info(i.i18n("buttons.copyTitle","Copy to clipboard"),i.i18n("buttons.copyInfo",{_:"Copied %d rows to clipboard",1:"Copied 1 row to clipboard"},a.rows),3e3)}},fieldSeparator:"\t",fieldBoundary:""}),n.ext.buttons.csvFlash=e.extend({},u,{className:"buttons-csv buttons-flash",text:function e(t){return t.i18n("buttons.csv","CSV")},action:function e(t,i,s,n){var o=n._flash,a=f(i,n),l=n.customize?n.customize(a.str,n):a.str;o.setAction("csv"),o.setFileName(r(n)),c(o,l)},escapeChar:'"'}),n.ext.buttons.excelFlash=e.extend({},u,{className:"buttons-excel buttons-flash",text:function e(t){return t.i18n("buttons.excel","Excel")},action:function t(i,n,o,a){var h="",d=a._flash,f=n.buttons.exportData(a.exportOptions),u=function t(i){for(var n=[],o=0,a=i.length;a>o;o++){null!==i[o]&&i[o]!==s||(i[o]=""),n.push("number"==typeof i[o]||i[o].match&&e.trim(i[o]).match(/^-?\d+(\.\d+)?$/)&&"0"!==i[o].charAt(0)?'<c t="n"><v>'+i[o]+"</v></c>":'<c t="inlineStr"><is><t>'+(i[o].replace?i[o].replace(/&(?!amp;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/[\x00-\x1F\x7F-\x9F]/g,""):i[o])+"</t></is></c>")}return"<row>"+n.join("")+"</row>"};a.header&&(h+=u(f.header));for(var m=0,p=f.body.length;p>m;m++){h+=u(f.body[m])}a.footer&&(h+=u(f.footer)),d.setAction("excel"),d.setFileName(r(a)),d.setSheetName(l(a)),c(d,h)},extension:".xlsx"}),n.ext.buttons.pdfFlash=e.extend({},u,{className:"buttons-pdf buttons-flash",text:function e(t){return t.i18n("buttons.pdf","PDF")},action:function e(t,i,s,n){var o=n._flash,a=i.buttons.exportData(n.exportOptions),l=i.table().node().offsetWidth,d=i.columns(n.columns).indexes().map(function(e){return i.column(e).header().offsetWidth/l});o.setAction("pdf"),o.setFileName(h(n)),c(o,JSON.stringify({title:r(n,!1),message:n.message,colWidth:d.toArray(),orientation:n.orientation,size:n.pageSize,header:n.header?a.header:null,footer:n.footer?a.footer:null,body:a.body}))},extension:".pdf",orientation:"portrait",pageSize:"A4",message:"",newline:"\n"}),n.Buttons});