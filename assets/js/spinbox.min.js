!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t(require("jquery")):t(jQuery)}(function(t){var i=t.fn.spinbox,s=function i(s,e){this.$element=t(s),this.$element.find(".btn").on("click",function(t){t.preventDefault()}),this.options=t.extend({},t.fn.spinbox.defaults,e),this.options.step=this.$element.data("step")||this.options.step,this.options.value<this.options.min?this.options.value=this.options.min:this.options.max<this.options.value&&(this.options.value=this.options.max),this.$input=this.$element.find(".spinbox-input"),this.$input.on("focusout.fu.spinbox",this.$input,t.proxy(this.change,this)),this.$element.on("keydown.fu.spinbox",this.$input,t.proxy(this.keydown,this)),this.$element.on("keyup.fu.spinbox",this.$input,t.proxy(this.keyup,this)),this.bindMousewheelListeners(),this.mousewheelTimeout={},this.options.hold?(this.$element.on("mousedown.fu.spinbox",".spinbox-up",t.proxy(function(){this.startSpin(!0)},this)),this.$element.on("mouseup.fu.spinbox",".spinbox-up, .spinbox-down",t.proxy(this.stopSpin,this)),this.$element.on("mouseout.fu.spinbox",".spinbox-up, .spinbox-down",t.proxy(this.stopSpin,this)),this.$element.on("mousedown.fu.spinbox",".spinbox-down",t.proxy(function(){this.startSpin(!1)},this))):(this.$element.on("click.fu.spinbox",".spinbox-up",t.proxy(function(){this.step(!0)},this)),this.$element.on("click.fu.spinbox",".spinbox-down",t.proxy(function(){this.step(!1)},this))),this.switches={count:1,enabled:!0},"medium"===this.options.speed?this.switches.speed=300:"fast"===this.options.speed?this.switches.speed=100:this.switches.speed=500,this.options.defaultUnit=n(this.options.defaultUnit,this.options.units)?this.options.defaultUnit:"",this.unit=this.options.defaultUnit,this.lastValue=this.options.value,this.render(),this.options.disabled&&this.disable()},e=function t(i,s){return Math.round(i/s)*s},n=function i(s,e){var n=!1,i=s.toLowerCase();return t.each(e,function(t,s){return s=s.toLowerCase(),i===s?(n=!0,!1):void 0}),n},o=function t(i){return isNaN(parseFloat(i))?i:(i>this.options.max?i=this.options.cycle?this.options.min:this.options.max:i<this.options.min&&(i=this.options.cycle?this.options.max:this.options.min),this.options.limitToStep&&this.options.step&&(i=e(i,this.options.step),i>this.options.max?i-=this.options.step:i<this.options.min&&(i+=this.options.step)),i)};s.prototype={constructor:s,destroy:function i(){return this.$element.remove(),this.$element.find("input").each(function(){t(this).attr("value",t(this).val())}),this.$element[0].outerHTML},render:function t(){this.setValue(this.getDisplayValue())},change:function t(){this.setValue(this.getDisplayValue()),this.triggerChangedEvent()},stopSpin:function t(){void 0!==this.switches.timeout&&(clearTimeout(this.switches.timeout),this.switches.count=1,this.triggerChangedEvent())},triggerChangedEvent:function t(){var i=this.getValue();i!==this.lastValue&&(this.lastValue=i,this.$element.trigger("changed.fu.spinbox",i))},startSpin:function i(s){if(!this.options.disabled){var e=this.switches.count;1===e?(this.step(s),e=1):e=3>e?1.5:8>e?2.5:4,this.switches.timeout=setTimeout(t.proxy(function(){this.iterate(s)},this),this.switches.speed/e),this.switches.count++}},iterate:function t(i){this.step(i),this.startSpin(i)},step:function t(i){this.setValue(this.getDisplayValue());var s;s=i?this.options.value+this.options.step:this.options.value-this.options.step,s=s.toFixed(5),this.setValue(s+this.unit)},getDisplayValue:function t(){var i=this.parseInput(this.$input.val()),s=i?i:this.options.value;return s},setDisplayValue:function t(i){this.$input.val(i)},getValue:function t(){var i=this.options.value;return"."!==this.options.decimalMark&&(i=(i+"").split(".").join(this.options.decimalMark)),i+this.unit},setValue:function t(i){if("."!==this.options.decimalMark&&(i=this.parseInput(i)),"number"!=typeof i){var s=i.replace(/[0-9.-]/g,"");this.unit=n(s,this.options.units)?s:this.options.defaultUnit}var e=this.getIntValue(i);return isNaN(e)&&!isFinite(e)?this.setValue(this.options.value):(e=o.call(this,e),this.options.value=e,i=e+this.unit,"."!==this.options.decimalMark&&(i=(i+"").split(".").join(this.options.decimalMark)),this.setDisplayValue(i),this)},value:function t(i){return i||0===i?this.setValue(i):this.getValue()},parseInput:function t(i){return i=(i+"").split(this.options.decimalMark).join(".")},getIntValue:function t(i){return i="undefined"==typeof i?this.getValue():i,"undefined"!=typeof i?("string"==typeof i&&(i=this.parseInput(i)),i=parseFloat(i,10)):void 0},disable:function t(){this.options.disabled=!0,this.$element.addClass("disabled"),this.$input.attr("disabled",""),this.$element.find("button").addClass("disabled")},enable:function t(){this.options.disabled=!1,this.$element.removeClass("disabled"),this.$input.removeAttr("disabled"),this.$element.find("button").removeClass("disabled")},keydown:function t(i){var s=i.keyCode;38===s?this.step(!0):40===s?this.step(!1):13===s&&this.change()},keyup:function t(i){var s=i.keyCode;38!==s&&40!==s||this.triggerChangedEvent()},bindMousewheelListeners:function i(){var s=this.$input.get(0);s.addEventListener?(s.addEventListener("mousewheel",t.proxy(this.mousewheelHandler,this),!1),s.addEventListener("DOMMouseScroll",t.proxy(this.mousewheelHandler,this),!1)):s.attachEvent("onmousewheel",t.proxy(this.mousewheelHandler,this))},mousewheelHandler:function t(i){if(!this.options.disabled){var s=window.event||i,e=Math.max(-1,Math.min(1,s.wheelDelta||-s.detail)),n=this;return clearTimeout(this.mousewheelTimeout),this.mousewheelTimeout=setTimeout(function(){n.triggerChangedEvent()},300),0>e?this.step(!0):this.step(!1),s.preventDefault?s.preventDefault():s.returnValue=!1,!1}}},t.fn.spinbox=function(i){var e,n=Array.prototype.slice.call(arguments,1),o=this.each(function(){var o=t(this),h=o.data("fu.spinbox"),u="object"==typeof i&&i;h||o.data("fu.spinbox",h=new s(this,u)),"string"==typeof i&&(e=h[i].apply(h,n))});return void 0===e?o:e},t.fn.spinbox.defaults={value:0,min:0,max:999,step:1,hold:!0,speed:"medium",disabled:!1,cycle:!1,units:[],decimalMark:".",defaultUnit:"",limitToStep:!1},t.fn.spinbox.Constructor=s,t.fn.spinbox.noConflict=function(){return t.fn.spinbox=i,this},t(document).on("mousedown.fu.spinbox.data-api","[data-initialize=spinbox]",function(i){var s=t(i.target).closest(".spinbox");s.data("fu.spinbox")||s.spinbox(s.data())}),t(function(){t("[data-initialize=spinbox]").each(function(){var i=t(this);i.data("fu.spinbox")||i.spinbox(i.data())})})});