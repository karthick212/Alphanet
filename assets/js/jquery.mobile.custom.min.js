!function(e,t,n){"function"==typeof define&&define.amd?define(["jquery"],function(o){return n(o,e,t),o.mobile}):n(e.jQuery,e,t)}(this,document,function(e,t,n,o){!function(e,t,n,o){function i(e){for(;e&&"undefined"!=typeof e.originalEvent;){e=e.originalEvent}return e}function s(t,n){var s,a,r,c,u,l,p,h,v,d=t.type;if(t=e.Event(t),t.type=n,s=t.originalEvent,a=e.event.props,d.search(/^(mouse|click)/)>-1&&(a=x),s)for(p=a.length,c;p;){c=a[--p],t[c]=s[c]}if(d.search(/mouse(down|up)|click/)>-1&&!t.which&&(t.which=1),-1!==d.search(/^touch/)&&(r=i(s),d=r.touches,u=r.changedTouches,l=d&&d.length?d[0]:u&&u.length?u[0]:o))for(h=0,v=M.length;v>h;h++){c=M[h],t[c]=l[c]}return t}function a(t){for(var n,o,i={};t;){n=e.data(t,X);for(o in n){n[o]&&(i[o]=i.hasVirtualBinding=!0)}t=t.parentNode}return i}function r(t,n){for(var o;t;){if(o=e.data(t,X),o&&(!n||o[n]))return t;t=t.parentNode}return null}function c(){F=!1}function u(){F=!0}function l(){Q=0,j.length=0,z=!1,u()}function p(){c()}function h(){v(),L=setTimeout(function(){L=0,l()},e.vmouse.resetTimerDuration)}function v(){L&&(clearTimeout(L),L=0)}function d(t,n,o){var i;return(o&&o[t]||!o&&r(n.target,t))&&(i=s(n,t),e(n.target).trigger(i)),i}function f(t){var n,o=e.data(t.target,Y);z||Q&&Q===o||(n=d("v"+t.type,t),n&&(n.isDefaultPrevented()&&t.preventDefault(),n.isPropagationStopped()&&t.stopPropagation(),n.isImmediatePropagationStopped()&&t.stopImmediatePropagation()))}function m(t){var n,o,s,r=i(t).touches;r&&1===r.length&&(n=t.target,o=a(n),o.hasVirtualBinding&&(Q=q++,e.data(n,Y,Q),v(),p(),N=!1,s=i(t).touches[0],O=s.pageX,B=s.pageY,d("vmouseover",t,o),d("vmousedown",t,o)))}function g(e){F||(N||d("vmousecancel",e,a(e.target)),N=!0,h())}function w(t){if(!F){var n=i(t).touches[0],o=N,s=e.vmouse.moveDistanceThreshold,r=a(t.target);N=N||Math.abs(n.pageX-O)>s||Math.abs(n.pageY-B)>s,N&&!o&&d("vmousecancel",t,r),d("vmousemove",t,r),h()}}function b(e){if(!F){u();var t,n,o=a(e.target);d("vmouseup",e,o),N||(t=d("vclick",e,o),t&&t.isDefaultPrevented()&&(n=i(e).changedTouches[0],j.push({touchID:Q,x:n.clientX,y:n.clientY}),z=!0)),d("vmouseout",e,o),N=!1,h()}}function T(t){var n,o=e.data(t,X);if(o)for(n in o){if(o[n])return!0}return!1}function D(){}function y(t){var n=t.substr(1);return{setup:function o(){T(this)||e.data(this,X,{});var i=e.data(this,X);i[t]=!0,S[t]=(S[t]||0)+1,1===S[t]&&V.bind(n,f),e(this).bind(n,D),H&&(S.touchstart=(S.touchstart||0)+1,1===S.touchstart&&V.bind("touchstart",m).bind("touchend",b).bind("touchmove",w).bind("scroll",g))},teardown:function o(){--S[t],S[t]||V.unbind(n,f),H&&(--S.touchstart,S.touchstart||V.unbind("touchstart",m).unbind("touchmove",w).unbind("touchend",b).unbind("scroll",g));var i=e(this),s=e.data(this,X);s&&(s[t]=!1),i.unbind(n,D),T(this)||i.removeData(X)}}}var E,P,X="virtualMouseBindings",Y="virtualTouchID",k="vmouseover vmousedown vmousemove vmouseup vclick vmouseout vmousecancel".split(" "),M="clientX clientY pageX pageY screenX screenY".split(" "),I=e.event.mouseHooks?e.event.mouseHooks.props:[],x=e.event.props.concat(I),S={},L=0,O=0,B=0,N=!1,j=[],z=!1,F=!1,H="addEventListener"in n,V=e(n),q=1,Q=0;for(e.vmouse={moveDistanceThreshold:10,clickDistanceThreshold:10,resetTimerDuration:1500},P=0;P<k.length;P++){e.event.special[k[P]]=y(k[P])}H&&n.addEventListener("click",function(t){var n,o,i,s,a,r,c=j.length,u=t.target;if(c)for(n=t.clientX,o=t.clientY,E=e.vmouse.clickDistanceThreshold,i=u;i;){for(s=0;c>s;s++){if(a=j[s],r=0,i===u&&Math.abs(a.x-n)<E&&Math.abs(a.y-o)<E||e.data(i,Y)===a.touchID)return t.preventDefault(),void t.stopPropagation()}i=i.parentNode}},!0)}(e,t,n),function(e){e.mobile={}}(e),function(e,t){var o={touch:"ontouchend"in n};e.mobile.support=e.mobile.support||{},e.extend(e.support,o),e.extend(e.mobile.support,o)}(e),function(e,t,o){function i(t,n,i,s){var a=i.type;i.type=n,s?e.event.trigger(i,o,t):e.event.dispatch.call(t,i),i.type=a}var s=e(n),a=e.mobile.support.touch,r="touchmove scroll",c=a?"touchstart":"mousedown",u=a?"touchend":"mouseup",l=a?"touchmove":"mousemove";e.each("touchstart touchmove touchend tap taphold swipe swipeleft swiperight scrollstart scrollstop".split(" "),function(t,n){e.fn[n]=function(e){return e?this.bind(n,e):this.trigger(n)},e.attrFn&&(e.attrFn[n]=!0)}),e.event.special.scrollstart={enabled:!0,setup:function t(){function n(e,t){o=t,i(a,o?"scrollstart":"scrollstop",e)}var o,s,a=this,c=e(a);c.bind(r,function(t){e.event.special.scrollstart.enabled&&(o||n(t,!0),clearTimeout(s),s=setTimeout(function(){n(t,!1)},50))})},teardown:function t(){e(this).unbind(r)}},e.event.special.tap={tapholdThreshold:750,emitTapOnTaphold:!0,setup:function t(){var n=this,o=e(n),a=!1;o.bind("vmousedown",function(t){function r(){clearTimeout(l)}function c(){r(),o.unbind("vclick",u).unbind("vmouseup",r),s.unbind("vmousecancel",c)}function u(e){c(),a||p!==e.target?a&&e.preventDefault():i(n,"tap",e)}if(a=!1,t.which&&1!==t.which)return!1;var l,p=t.target;o.bind("vmouseup",r).bind("vclick",u),s.bind("vmousecancel",c),l=setTimeout(function(){e.event.special.tap.emitTapOnTaphold||(a=!0),i(n,"taphold",e.Event("taphold",{target:p}))},e.event.special.tap.tapholdThreshold)})},teardown:function t(){e(this).unbind("vmousedown").unbind("vclick").unbind("vmouseup"),s.unbind("vmousecancel")}},e.event.special.swipe={scrollSupressionThreshold:30,durationThreshold:1e3,horizontalDistanceThreshold:30,verticalDistanceThreshold:30,getLocation:function e(n){var o=t.pageXOffset,i=t.pageYOffset,s=n.clientX,a=n.clientY;return 0===n.pageY&&Math.floor(a)>Math.floor(n.pageY)||0===n.pageX&&Math.floor(s)>Math.floor(n.pageX)?(s-=o,a-=i):(a<n.pageY-i||s<n.pageX-o)&&(s=n.pageX-o,a=n.pageY-i),{x:s,y:a}},start:function t(n){var o=n.originalEvent.touches?n.originalEvent.touches[0]:n,i=e.event.special.swipe.getLocation(o);return{time:(new Date).getTime(),coords:[i.x,i.y],origin:e(n.target)}},stop:function t(n){var o=n.originalEvent.touches?n.originalEvent.touches[0]:n,i=e.event.special.swipe.getLocation(o);return{time:(new Date).getTime(),coords:[i.x,i.y]}},handleSwipe:function t(n,o,s,a){if(o.time-n.time<e.event.special.swipe.durationThreshold&&Math.abs(n.coords[0]-o.coords[0])>e.event.special.swipe.horizontalDistanceThreshold&&Math.abs(n.coords[1]-o.coords[1])<e.event.special.swipe.verticalDistanceThreshold){var r=n.coords[0]>o.coords[0]?"swipeleft":"swiperight";return i(s,"swipe",e.Event("swipe",{target:a,swipestart:n,swipestop:o}),!0),i(s,r,e.Event(r,{target:a,swipestart:n,swipestop:o}),!0),!0}return!1},eventInProgress:!1,setup:function t(){var n,o=this,i=e(o),a={};n=e.data(this,"mobile-events"),n||(n={length:0},e.data(this,"mobile-events",n)),n.length++,n.swipe=a,a.start=function(t){if(!e.event.special.swipe.eventInProgress){e.event.special.swipe.eventInProgress=!0;var n,i=e.event.special.swipe.start(t),r=t.target,c=!1;a.move=function(t){i&&!t.isDefaultPrevented()&&(n=e.event.special.swipe.stop(t),c||(c=e.event.special.swipe.handleSwipe(i,n,o,r),c&&(e.event.special.swipe.eventInProgress=!1)),Math.abs(i.coords[0]-n.coords[0])>e.event.special.swipe.scrollSupressionThreshold&&t.preventDefault())},a.stop=function(){c=!0,e.event.special.swipe.eventInProgress=!1,s.off(l,a.move),a.move=null},s.on(l,a.move).one(u,a.stop)}},i.on(c,a.start)},teardown:function t(){var n,o;n=e.data(this,"mobile-events"),n&&(o=n.swipe,delete n.swipe,n.length--,0===n.length&&e.removeData(this,"mobile-events")),o&&(o.start&&e(this).off(c,o.start),o.move&&s.off(l,o.move),o.stop&&s.off(u,o.stop))}},e.each({scrollstop:"scrollstart",taphold:"tap",swipeleft:"swipe.left",swiperight:"swipe.right"},function(t,n){e.event.special[t]={setup:function t(){e(this).bind(n,e.noop)},teardown:function t(){e(this).unbind(n)}}})}(e,this)});